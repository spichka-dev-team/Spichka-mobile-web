(()=>{var e={};e.id=534,e.ids=[534],e.modules={1154:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});var s=r(60687),a=r(43210),i=r(96241);let n=a.forwardRef(({className:e,type:t,...r},a)=>(0,s.jsx)("input",{type:t,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...r}));n.displayName="Input"},1837:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c});var s=r(65239),a=r(48088),i=r(88170),n=r.n(i),o=r(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let c={children:["",{children:["(platform)",{children:["search",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,72685)),"/root/spichka/Spichka-mobile-web/app/(platform)/search/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,82937)),"/root/spichka/Spichka-mobile-web/app/(platform)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,58014)),"/root/spichka/Spichka-mobile-web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["/root/spichka/Spichka-mobile-web/app/(platform)/search/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(platform)/search/page",pathname:"/search",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},41862:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},48368:(e,t,r)=>{"use strict";r.d(t,{SearchPage:()=>j});var s=r(60687),a=r(43210),i=r.n(a),n=r(96241),o=r(41862);let l=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",e),...t}));l.displayName="Card",a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...t})).displayName="CardHeader",a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,n.cn)("font-semibold leading-none tracking-tight",e),...t})).displayName="CardTitle",a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",e),...t})).displayName="CardDescription",a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",e),...t})).displayName="CardContent",a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter";var c=r(62688);let d=(0,c.A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),u=(0,c.A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var p=r(85814),m=r.n(p),x=r(30474);let h=e=>(0,s.jsx)(l,{className:"bg-white-glass border-none rounded-2xl overflow-hidden hover:bg-muted/50 transition-colors",children:(0,s.jsx)(m(),{href:e.link,children:(0,s.jsxs)("div",{className:"flex items-center px-4 gap-4",children:[(0,s.jsx)("div",{className:"relative w-20 h-20 rounded-xl overflow-hidden bg-muted flex-shrink-0",children:(0,s.jsx)(x.default,{src:`/api/proxy/image?id=${e.image}`,alt:"title"in e&&e.title?e.title:"",width:80,height:80,className:"w-full h-full object-cover"})}),(0,s.jsxs)("div",{className:"flex-1 space-y-1 min-w-0 py-4",children:["event"===e.type&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{className:"font-unbounded font-medium text-xl text-white truncate",children:e.title}),(0,s.jsxs)("div",{className:"font-geologica text-sm text-muted-foreground",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(d,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:e.tag})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(u,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:e.date})]})]})]}),"location"===e.type&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{className:"font-unbounded font-medium text-xl text-white truncate",children:e.title}),(0,s.jsx)("p",{className:"font-geologica text-sm text-muted-foreground truncate",children:e.subtitle}),(0,s.jsx)("p",{className:"font-geologica text-sm text-muted-foreground truncate",children:e.address})]}),"creator"===e.type&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("p",{className:"font-geologica text-sm text-muted-foreground truncate",children:e.description})})]})]})})});var f=r(99270),g=r(1154);let v=({setSearchQuery:e,searchQuery:t,className:r})=>{let a=i().useRef(null);return(0,s.jsxs)("div",{ref:a,className:(0,n.cn)("flex rounded-2xl flex-1 justify-between relative h-11 z-30",r),children:[(0,s.jsx)(f.A,{className:"absolute scale-x-[-1] top-1/2 translate-y-[-50%] left-3 h-5 text-white"}),(0,s.jsx)(g.p,{className:"rounded-2xl outline-none border-none w-full bg-white-glass pl-11",type:"text",placeholder:"поиск...",onChange:t=>e(t.target.value),value:t})]})};var b=r(71232),y=r(51060);let j=({className:e})=>{let[t,r]=(0,a.useState)(""),[i,l]=(0,a.useState)(""),[c,d]=(0,a.useState)("ивенты"),[u,p]=(0,a.useState)(!1),[m,x]=(0,a.useState)(null),[f,g]=(0,a.useState)([]);!function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=[]);var s,i,n,o,l,c,d=(void 0===(s=t)&&(s=0),i=(0,a.useRef)(!1),n=(0,a.useRef)(),o=(0,a.useRef)(e),l=(0,a.useCallback)(function(){return i.current},[]),c=(0,a.useCallback)(function(){i.current=!1,n.current&&clearTimeout(n.current),n.current=setTimeout(function(){i.current=!0,o.current()},s)},[s]),[l,(0,a.useCallback)(function(){i.current=null,n.current&&clearTimeout(n.current)},[]),c]);d[0],d[1],d[2]}(()=>l(t),500,[t]);let j=async(e,t)=>{if(!e.trim())return void g([]);p(!0),x(null);try{let r="",s={};switch(t){case"ивенты":r="Event",s={_or:[{title:{_icontains:e.trim()}}]};break;case"локации":r="Community_Group",s={_or:[{name:{_icontains:e.trim()}}]};break;case"креаторы":r="Creator",s={_or:[{bio:{_icontains:e.trim()}}]}}let a=`/api/proxy/search?path=items/${r}&filter=${encodeURIComponent(JSON.stringify(s))}`;console.log("обращаемся к:"+a);let i=(await y.A.get(a)).data,n=await i;console.log(n);let o=n.data.map(e=>{switch(t){case"ивенты":return{type:"event",id:e.id,image:e.picture,title:e.title,date:new Date(e.start_date).toLocaleDateString("ru-RU",{day:"2-digit",month:"long"}),tag:e.tags?.[0]||"",link:`/event/${e.id}`};case"локации":return{type:"location",id:e.id,image:e.profile_picture,title:e.name,subtitle:e.subtitle||"",address:e.address||"",link:`/location/${e.id}`};case"креаторы":return{type:"creator",id:e.id,image:e.banner_picture,description:e.bio,link:`/creator/${e.id}`}}});g(o)}catch(e){x(e instanceof Error?e.message:"Произошла ошибка")}finally{p(!1)}};return(0,a.useEffect)(()=>{j(i,c)},[i,c]),(0,s.jsxs)("main",{className:(0,n.cn)("flex flex-col gap-6 pt-4 pb-24 px-2",e),children:[(0,s.jsx)(v,{searchQuery:t,setSearchQuery:r}),(0,s.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-2",children:["ивенты","локации","креаторы"].map(e=>(0,s.jsx)(b.$,{variant:c===e?"default":"secondary",size:"sm",className:"rounded-full whitespace-nowrap",onClick:()=>d(e),children:e},e))}),u&&(0,s.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,s.jsx)(o.A,{className:"h-6 w-6 animate-spin"}),(0,s.jsx)("span",{className:"ml-2",children:"Поиск..."})]}),m&&(0,s.jsx)("div",{className:"text-center py-8 text-destructive",children:m}),!i&&!u&&(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"Введите запрос для поиска"}),f.length>0&&(0,s.jsx)("div",{className:"flex flex-col gap-4",children:f.map(e=>(0,s.jsx)(h,{...e},`${e.type}-${e.id}`))})]})}},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},62472:(e,t,r)=>{Promise.resolve().then(r.bind(r,48368))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63806:(e,t,r)=>{"use strict";r.d(t,{SearchPage:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call SearchPage() from the server but SearchPage is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/root/spichka/Spichka-mobile-web/components/pages/SearchPage/ui/SearchPage.tsx","SearchPage")},72685:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(37413);r(61120);var a=r(63806);async function i(){return(0,s.jsx)(a.SearchPage,{})}},74075:e=>{"use strict";e.exports=require("zlib")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},83997:e=>{"use strict";e.exports=require("tty")},94735:e=>{"use strict";e.exports=require("events")},98920:(e,t,r)=>{Promise.resolve().then(r.bind(r,63806))}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[243,783,612,567,558,17,60,475,673,290,464],()=>r(1837));module.exports=s})();